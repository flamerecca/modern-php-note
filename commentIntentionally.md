# 函式內加入單行註解

有時候，隨著程式成長，我們會有一個很大的函式。

```php
public function getResponce()
{
    /**
    處理輸入……
    */
    /**
    檢查輸入格式……
    */
    /**
    從資料庫收集資料……
    */
    /**
    處理回傳內容……
    */
}
```

肥大的函式本身其實就是一個壞味道了。但是要做改變常常並不容易，看著已經肥大的函式，常常會讓人望而卻步，不知道怎麼去修改這段函式。

這時候，我自己會先在我所不理解的事情前面，先加上每個段落的註解。  
段落註解通常是單行註解。

```php
public function getResponce()
{
    //TODO 處理輸入 handleInput()
    /**
    處理輸入……
    */

    //TODO 輸入格式檢查 formatCheck()
    /**
    檢查輸入格式……
    */

    //TODO 收集內部資料 innerDataCollect()
    /**
    從資料庫收集資料……
    */

    //TODO 回傳內容處理 handleOutput()
    /**
    處理回傳內容……
    */
}
```

好不容易看懂了整個函式，現在我們可以去喝杯咖啡，好好休息一下。

如果你的時程很忙碌的話，可能時隔很長一陣子之後，你才會回頭看到這一段程式。

不過當你看到這段程式的時候，即使你已經忘記當初想了什麼，但是你會看到裡面充滿了單行註解的壞味道，還有大量的 TODO。

單行註解的壞味道很好處理。我們只需要將這一段一段的程式抽出，成為單一的函式（Extract Method）即可。我們甚至不用一次把所有函式都抽出來，可以一次抽一段就好。這樣是不是很棒呢？

### 註解函式名稱

在 TODO 裡面，我會先將我想到的可能函式名稱也註解在內。

因為我常常會無法當下決定出，怎樣的函式名稱可以簡潔正確的表現這段程式，所以我會先下註解。既然我能說服我自己「現在只不過是註解」，我就可以沒有壓力的寫我自己目前的想法。

下次看到時，通常我可以想到更好的名稱，並改善這一段註解。如果我沒想到更好的名稱，那應該就是這個名稱已經很棒了，可以拿來使用。



## 太多小函式？

重構的時候，我發現自己有時候會卻步，不願意將函式切得更小。

這時候，我就會回去看看我當初的段落註解。提醒自己：雖然現在我對程式很熟悉，已經知道這一段程式碼在做什麼，但是幾個月之前的我並不清楚。

也就是說，如果有其他工程師來看，很可能跟幾個月前的我一樣，看不懂這段程式。所以抽取出來很可能是必要的。

再說，連許多著名的框架都常常有兩行甚至單行內容的函式，像是這樣：

```php
     /**
     * Determine if the request is the result of an PJAX call.
     *
     * @return bool
     */
    public function pjax()
    {
        return $this->headers->get('X-PJAX') == true;
    }
```

這樣的函式，可以讓其他地方使用時，看起來更容易理解。我們有什麼好怕的呢？

## TODO？

多數的

這樣可以讓我們內心的壓力減輕：TODO 裡面的所註解的事情，並不一定得馬上做。即使不馬上做，程式也不會死掉。

這還有一個好處是，你合作的 program mansger 不需要為了你重構的時程而緊張。從他的角度來看，你所應該做出來的功能已經可以測試與運作了。你只是

只要養成習慣，每次固定清理一些 TODO，程式的重構就自然會完成。

